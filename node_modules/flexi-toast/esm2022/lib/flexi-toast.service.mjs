import { Injectable } from '@angular/core';
import * as i0 from "@angular/core";
export class FlexiToastService {
    constructor(rendererFactory) {
        this.options = new FlexiToastOptionsModel();
        this.renderer = rendererFactory.createRenderer(null, null);
    }
    showToast(title, text, icon = "success", options) {
        if (!options) {
            options = this.options;
        }
        options.icon = icon;
        let wrapper = document.querySelector(".flexi-toast-wrapper");
        if (!wrapper) {
            wrapper = this.renderer.createElement('div');
            this.renderer.addClass(wrapper, `flexi-toast-wrapper`);
            this.renderer.addClass(wrapper, `flexi-taost-${options.position}`);
            const body = this.renderer.selectRootElement('body', true);
            this.renderer.appendChild(body, wrapper);
        }
        else {
            wrapper.className = `flexi-toast-wrapper flexi-taost-${options.position}`;
            if (options.preventDuplicate) {
                const allEl = document.querySelectorAll(".flexi-toast");
                if (allEl) {
                    for (const el of allEl) {
                        this.renderer.removeChild(wrapper, el);
                    }
                }
            }
        }
        const toast = this.renderer.createElement('div');
        this.renderer.addClass(toast, 'flexi-toast');
        this.renderer.addClass(toast, `flexi-toast-${options.icon}`);
        this.renderer.setAttribute(toast, `data-bs-theme`, options.themeClass);
        if (!options.showCloseBtn) {
            this.renderer.listen(toast, 'click', () => {
                this.renderer.removeClass(toast, 'flexi-toast-fade-in');
                this.renderer.addClass(toast, 'flexi-toast-fade-out');
                setTimeout(() => {
                    this.renderer.removeChild(wrapper, toast);
                }, 500);
            });
        }
        const container = this.renderer.createElement('div');
        this.renderer.addClass(container, 'flexi-toast-container');
        const container1 = this.renderer.createElement('div');
        this.renderer.addClass(container1, 'flexi-toast-container-1');
        // SVG ikonu eklemek
        const svgIcon = this.renderer.createElement('svg', 'http://www.w3.org/2000/svg');
        this.renderer.setAttribute(svgIcon, 'xmlns', 'http://www.w3.org/2000/svg');
        this.renderer.setAttribute(svgIcon, 'viewBox', '0 0 512 512');
        const path = this.renderer.createElement('path', 'http://www.w3.org/2000/svg');
        if (options.icon === "success") {
            this.renderer.setAttribute(path, 'd', 'M504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zM227.3 387.3l184-184c6.2-6.2 6.2-16.4 0-22.6l-22.6-22.6c-6.2-6.2-16.4-6.2-22.6 0L216 308.1l-70.1-70.1c-6.2-6.2-16.4-6.2-22.6 0l-22.6 22.6c-6.2 6.2-6.2 16.4 0 22.6l104 104c6.2 6.2 16.4 6.2 22.6 0z');
        }
        else if (options.icon === "warning") {
            this.renderer.setAttribute(path, 'd', 'M504 256c0 137-111 248-248 248S8 393 8 256C8 119.1 119 8 256 8s248 111.1 248 248zm-248 50c-25.4 0-46 20.6-46 46s20.6 46 46 46 46-20.6 46-46-20.6-46-46-46zm-43.7-165.3l7.4 136c.3 6.4 5.6 11.3 12 11.3h48.5c6.4 0 11.6-5 12-11.3l7.4-136c.4-6.9-5.1-12.7-12-12.7h-63.4c-6.9 0-12.4 5.8-12 12.7z');
        }
        else if (options.icon === "info") {
            this.renderer.setAttribute(path, 'd', 'M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z');
        }
        else if (options.icon === "error") {
            this.renderer.setAttribute(path, 'd', 'M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z');
        }
        this.renderer.appendChild(svgIcon, path);
        this.renderer.appendChild(container1, svgIcon);
        const container2 = this.renderer.createElement('div');
        this.renderer.addClass(container2, 'flexi-toast-container-2');
        const titleEl = this.renderer.createElement('span');
        const titleText = this.renderer.createText(title);
        this.renderer.appendChild(titleEl, titleText);
        const message = this.renderer.createElement('span');
        const messageText = this.renderer.createText(text);
        this.renderer.appendChild(message, messageText);
        this.renderer.appendChild(container2, titleEl);
        this.renderer.appendChild(container2, message);
        this.renderer.appendChild(container, container1);
        this.renderer.appendChild(container, container2);
        if (options.autoClose && options.showProgressBar) {
            const progressBar = this.renderer.createElement('div');
            this.renderer.addClass(progressBar, 'flexi-toast-progress-bar');
            this.renderer.addClass(progressBar, `flex-toast-progress-bar-${options.icon}`);
            this.renderer.appendChild(toast, progressBar);
            // Add animation to progress bar
            this.renderer.setStyle(progressBar, 'transition', `width ${options.timeOut}ms linear`);
            this.renderer.setStyle(progressBar, 'width', '100%');
            setTimeout(() => {
                this.renderer.setStyle(progressBar, 'width', '0%');
            }, 10);
        }
        this.renderer.appendChild(toast, container);
        if (options.showCloseBtn) {
            const closeBtn = this.renderer.createElement('span');
            this.renderer.addClass(closeBtn, 'flexi-toast-close-btn');
            const closeText = this.renderer.createText('×');
            this.renderer.appendChild(closeBtn, closeText);
            this.renderer.listen(closeBtn, 'click', () => {
                this.renderer.removeClass(toast, 'flexi-toast-fade-in');
                this.renderer.addClass(toast, 'flexi-toast-fade-out');
                setTimeout(() => {
                    this.renderer.removeChild(wrapper, toast);
                }, 500);
            });
            this.renderer.appendChild(toast, closeBtn);
        }
        this.renderer.appendChild(wrapper, toast);
        // Timeout to trigger the fade-in animation
        setTimeout(() => {
            this.renderer.addClass(toast, 'flexi-toast-fade-in');
        }, 10);
        if (options.autoClose) {
            setTimeout(() => {
                this.renderer.removeClass(toast, 'flexi-toast-fade-in');
                this.renderer.addClass(toast, 'flexi-toast-fade-out');
                setTimeout(() => {
                    this.renderer.removeChild(wrapper, toast);
                }, 500);
            }, options.timeOut);
        }
    }
    showSwal(title, text, callBack, confirmBtnText = this.options.confirmBtnText ?? "Delete", cancelBtnText = this.options.cancelBtnText ?? "Cancel") {
        const body = this.renderer.selectRootElement('body', true);
        const container = this.renderer.createElement('div');
        this.renderer.addClass(container, 'flexi-swal-container');
        this.renderer.setAttribute(container, `data-bs-theme`, this.options.themeClass);
        const content = this.renderer.createElement('div');
        this.renderer.addClass(content, 'flexi-swal-content');
        this.renderer.addClass(content, `flexi-swal-content-left-border-${this.options.swalContentThemeClass}`);
        // const iconContainer = this.renderer.createElement('div');
        // this.renderer.addClass(iconContainer, 'flexi-swal-icon');
        // const svgIcon = this.renderer.createElement('svg', 'http://www.w3.org/2000/svg');
        // this.renderer.setAttribute(svgIcon, 'xmlns', 'http://www.w3.org/2000/svg');
        // this.renderer.setAttribute(svgIcon, 'viewBox', '0 0 320 512');
        // this.renderer.setStyle(svgIcon, 'width', '20px');
        // const path = this.renderer.createElement('path', 'http://www.w3.org/2000/svg');
        // this.renderer.setAttribute(path, 'd', 'M80 160c0-35.3 28.7-64 64-64h32c35.3 0 64 28.7 64 64v3.6c0 21.8-11.1 42.1-29.4 53.8l-42.2 27.1c-25.2 16.2-40.4 44.1-40.4 74V320c0 17.7 14.3 32 32 32s32-14.3 32-32v-1.4c0-8.2 4.2-15.8 11-20.2l42.2-27.1c36.6-23.6 58.8-64.1 58.8-107.7V160c0-70.7-57.3-128-128-128H144C73.3 32 16 89.3 16 160c0 17.7 14.3 32 32 32s32-14.3 32-32zm80 320a40 40 0 1 0 0-80 40 40 0 1 0 0 80z');
        // this.renderer.appendChild(svgIcon, path);
        // this.renderer.appendChild(iconContainer, svgIcon);
        const closeBtn = this.renderer.createElement('span');
        this.renderer.addClass(closeBtn, 'flexi-swal-close-btn');
        const closeText = this.renderer.createText('×');
        this.renderer.appendChild(closeBtn, closeText);
        this.renderer.listen(closeBtn, 'click', () => {
            this.renderer.addClass(content, 'fade-out');
            setTimeout(() => {
                this.renderer.removeChild(body, container);
            }, 200);
        });
        this.renderer.appendChild(content, closeBtn);
        const titleEl = this.renderer.createElement('h1');
        const titleText = this.renderer.createText(title);
        this.renderer.appendChild(titleEl, titleText);
        const message = this.renderer.createElement('p');
        const messageText = this.renderer.createText(text);
        this.renderer.appendChild(message, messageText);
        const buttonsContainer = this.renderer.createElement('div');
        this.renderer.addClass(buttonsContainer, "flexi-swal-btn-container");
        const confirmButton = this.renderer.createElement('button');
        this.renderer.addClass(confirmButton, 'flexi-swal-btn');
        this.renderer.setStyle(confirmButton, 'margin-right', '5px');
        const confirmButtonText = this.renderer.createText(confirmBtnText);
        this.renderer.appendChild(confirmButton, confirmButtonText);
        const cancelButton = this.renderer.createElement('button');
        this.renderer.addClass(cancelButton, 'flexi-swal-btn-cancel');
        this.renderer.addClass(cancelButton, `flexi-swal-btn-cancel-background-${this.options.swalContentThemeClass}`);
        const cancelButtonText = this.renderer.createText(cancelBtnText);
        this.renderer.appendChild(cancelButton, cancelButtonText);
        this.renderer.listen(confirmButton, 'click', () => {
            callBack();
            this.renderer.addClass(content, 'fade-out');
            setTimeout(() => {
                this.renderer.removeChild(body, container);
            }, 200);
        });
        this.renderer.listen(cancelButton, 'click', () => {
            this.renderer.addClass(content, 'fade-out');
            setTimeout(() => {
                this.renderer.removeChild(body, container);
            }, 200);
        });
        this.renderer.appendChild(buttonsContainer, confirmButton);
        this.renderer.appendChild(buttonsContainer, cancelButton);
        //this.renderer.appendChild(content, iconContainer);
        this.renderer.appendChild(content, titleEl);
        this.renderer.appendChild(content, message);
        this.renderer.appendChild(content, buttonsContainer);
        this.renderer.appendChild(container, content);
        this.renderer.appendChild(body, container);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.0.6", ngImport: i0, type: FlexiToastService, deps: [{ token: i0.RendererFactory2 }], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "18.0.6", ngImport: i0, type: FlexiToastService, providedIn: 'root' }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.0.6", ngImport: i0, type: FlexiToastService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }], ctorParameters: () => [{ type: i0.RendererFactory2 }] });
export class FlexiToastOptionsModel {
    constructor() {
        this.icon = "success";
        this.autoClose = true;
        this.timeOut = 3000;
        this.showProgressBar = true;
        this.showCloseBtn = true;
        this.preventDuplicate = false;
        this.position = "bottom-right";
        this.themeClass = "light";
        this.cancelBtnText = "Cancel";
        this.confirmBtnText = "Delete";
        this.swalContentThemeClass = "error";
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmxleGktdG9hc3Quc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL2ZsZXhpLXRvYXN0L3NyYy9saWIvZmxleGktdG9hc3Quc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUErQixNQUFNLGVBQWUsQ0FBQzs7QUFLeEUsTUFBTSxPQUFPLGlCQUFpQjtJQU01QixZQUFZLGVBQWlDO1FBSjdDLFlBQU8sR0FBMkIsSUFBSSxzQkFBc0IsRUFBRSxDQUFDO1FBSzdELElBQUksQ0FBQyxRQUFRLEdBQUcsZUFBZSxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDN0QsQ0FBQztJQUVELFNBQVMsQ0FBQyxLQUFhLEVBQUUsSUFBWSxFQUFFLE9BQTJCLFNBQVMsRUFBRSxPQUFnQztRQUMzRyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7WUFDYixPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUN6QixDQUFDO1FBRUQsT0FBTyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFFcEIsSUFBSSxPQUFPLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO1FBQzdELElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUNiLE9BQU8sR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUM3QyxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUscUJBQXFCLENBQUMsQ0FBQztZQUN2RCxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsZUFBZSxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztZQUNuRSxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMs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QixHQUFnQyxPQUFPLENBQUM7SUFDL0QsQ0FBQztDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSwgUmVuZGVyZXIyLCBSZW5kZXJlckZhY3RvcnkyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5ASW5qZWN0YWJsZSh7XHJcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBGbGV4aVRvYXN0U2VydmljZSB7XHJcblxyXG4gIG9wdGlvbnM6IEZsZXhpVG9hc3RPcHRpb25zTW9kZWwgPSBuZXcgRmxleGlUb2FzdE9wdGlvbnNNb2RlbCgpO1xyXG5cclxuICBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyRmFjdG9yeTogUmVuZGVyZXJGYWN0b3J5Mikge1xyXG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyRmFjdG9yeS5jcmVhdGVSZW5kZXJlcihudWxsLCBudWxsKTtcclxuICB9XHJcblxyXG4gIHNob3dUb2FzdCh0aXRsZTogc3RyaW5nLCB0ZXh0OiBzdHJpbmcsIGljb246IEZsZXhpVG9hc3RJY29uVHlwZSA9IFwic3VjY2Vzc1wiLCBvcHRpb25zPzogRmxleGlUb2FzdE9wdGlvbnNNb2RlbCkge1xyXG4gICAgaWYgKCFvcHRpb25zKSB7XHJcbiAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XHJcbiAgICB9XHJcblxyXG4gICAgb3B0aW9ucy5pY29uID0gaWNvbjtcclxuXHJcbiAgICBsZXQgd3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZmxleGktdG9hc3Qtd3JhcHBlclwiKTtcclxuICAgIGlmICghd3JhcHBlcikge1xyXG4gICAgICB3cmFwcGVyID0gdGhpcy5yZW5kZXJlci5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh3cmFwcGVyLCBgZmxleGktdG9hc3Qtd3JhcHBlcmApO1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHdyYXBwZXIsIGBmbGV4aS10YW9zdC0ke29wdGlvbnMucG9zaXRpb259YCk7XHJcbiAgICAgIGNvbnN0IGJvZHkgPSB0aGlzLnJlbmRlcmVyLnNlbGVjdFJvb3RFbGVtZW50KCdib2R5JywgdHJ1ZSk7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQoYm9keSwgd3JhcHBlcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB3cmFwcGVyLmNsYXNzTmFtZSA9IGBmbGV4aS10b2FzdC13cmFwcGVyIGZsZXhpLXRhb3N0LSR7b3B0aW9ucy5wb3NpdGlvbn1gO1xyXG5cclxuICAgICAgaWYgKG9wdGlvbnMucHJldmVudER1cGxpY2F0ZSkge1xyXG4gICAgICAgIGNvbnN0IGFsbEVsOiBhbnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZsZXhpLXRvYXN0XCIpO1xyXG4gICAgICAgIGlmIChhbGxFbCkge1xyXG4gICAgICAgICAgZm9yIChjb25zdCBlbCBvZiBhbGxFbCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNoaWxkKHdyYXBwZXIsIGVsKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0b2FzdCA9IHRoaXMucmVuZGVyZXIuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRvYXN0LCAnZmxleGktdG9hc3QnKTtcclxuICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModG9hc3QsIGBmbGV4aS10b2FzdC0ke29wdGlvbnMuaWNvbn1gKTtcclxuICAgIHRoaXMucmVuZGVyZXIuc2V0QXR0cmlidXRlKHRvYXN0LCBgZGF0YS1icy10aGVtZWAsIG9wdGlvbnMudGhlbWVDbGFzcyEpXHJcblxyXG4gICAgaWYgKCFvcHRpb25zLnNob3dDbG9zZUJ0bikge1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0b2FzdCwgJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModG9hc3QsICdmbGV4aS10b2FzdC1mYWRlLWluJyk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0b2FzdCwgJ2ZsZXhpLXRvYXN0LWZhZGUtb3V0Jyk7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNoaWxkKHdyYXBwZXIsIHRvYXN0KTtcclxuICAgICAgICB9LCA1MDApO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyhjb250YWluZXIsICdmbGV4aS10b2FzdC1jb250YWluZXInKTtcclxuXHJcbiAgICBjb25zdCBjb250YWluZXIxID0gdGhpcy5yZW5kZXJlci5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3MoY29udGFpbmVyMSwgJ2ZsZXhpLXRvYXN0LWNvbnRhaW5lci0xJyk7XHJcblxyXG4gICAgLy8gU1ZHIGlrb251IGVrbGVtZWtcclxuICAgIGNvbnN0IHN2Z0ljb24gPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZUVsZW1lbnQoJ3N2ZycsICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycpO1xyXG4gICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUoc3ZnSWNvbiwgJ3htbG5zJywgJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZShzdmdJY29uLCAndmlld0JveCcsICcwIDAgNTEyIDUxMicpO1xyXG5cclxuICAgIGNvbnN0IHBhdGggPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZUVsZW1lbnQoJ3BhdGgnLCAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnKTtcclxuICAgIGlmIChvcHRpb25zLmljb24gPT09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuc2V0QXR0cmlidXRlKHBhdGgsICdkJywgJ001MDQgMjU2YzAgMTM3LTExMSAyNDgtMjQ4IDI0OFM4IDM5MyA4IDI1NiAxMTkgOCAyNTYgOHMyNDggMTExIDI0OCAyNDh6TTIyNy4zIDM4Ny4zbDE4NC0xODRjNi4yLTYuMiA2LjItMTYuNCAwLTIyLjZsLTIyLjYtMjIuNmMtNi4yLTYuMi0xNi40LTYuMi0yMi42IDBMMjE2IDMwOC4xbC03MC4xLTcwLjFjLTYuMi02LjItMTYuNC02LjItMjIuNiAwbC0yMi42IDIyLjZjLTYuMiA2LjItNi4yIDE2LjQgMCAyMi42bDEwNCAxMDRjNi4yIDYuMiAxNi40IDYuMiAyMi42IDB6Jyk7XHJcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMuaWNvbiA9PT0gXCJ3YXJuaW5nXCIpIHtcclxuICAgICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUocGF0aCwgJ2QnLCAnTTUwNCAyNTZjMCAxMzctMTExIDI0OC0yNDggMjQ4UzggMzkzIDggMjU2QzggMTE5LjEgMTE5IDggMjU2IDhzMjQ4IDExMS4xIDI0OCAyNDh6bS0yNDggNTBjLTI1LjQgMC00NiAyMC42LTQ2IDQ2czIwLjYgNDYgNDYgNDYgNDYtMjAuNiA0Ni00Ni0yMC42LTQ2LTQ2LTQ2em0tNDMuNy0xNjUuM2w3LjQgMTM2Yy4zIDYuNCA1LjYgMTEuMyAxMiAxMS4zaDQ4LjVjNi40IDAgMTEuNi01IDEyLTExLjNsNy40LTEzNmMuNC02LjktNS4xLTEyLjctMTItMTIuN2gtNjMuNGMtNi45IDAtMTIuNCA1LjgtMTIgMTIuN3onKTtcclxuICAgIH0gZWxzZSBpZiAob3B0aW9ucy5pY29uID09PSBcImluZm9cIikge1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZShwYXRoLCAnZCcsICdNMjU2IDUxMkEyNTYgMjU2IDAgMSAwIDI1NiAwYTI1NiAyNTYgMCAxIDAgMCA1MTJ6TTIxNiAzMzZoMjRWMjcySDIxNmMtMTMuMyAwLTI0LTEwLjctMjQtMjRzMTAuNy0yNCAyNC0yNGg0OGMxMy4zIDAgMjQgMTAuNyAyNCAyNHY4OGg4YzEzLjMgMCAyNCAxMC43IDI0IDI0cy0xMC43IDI0LTI0IDI0SDIxNmMtMTMuMyAwLTI0LTEwLjctMjQtMjRzMTAuNy0yNCAyNC0yNHptNDAtMjA4YTMyIDMyIDAgMSAxIDAgNjQgMzIgMzIgMCAxIDEgMC02NHonKTtcclxuICAgIH0gZWxzZSBpZiAob3B0aW9ucy5pY29uID09PSBcImVycm9yXCIpIHtcclxuICAgICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUocGF0aCwgJ2QnLCAnTTI1NiA4QzExOSA4IDggMTE5IDggMjU2czExMSAyNDggMjQ4IDI0OCAyNDgtMTExIDI0OC0yNDhTMzkzIDggMjU2IDh6bTEyMS42IDMxMy4xYzQuNyA0LjcgNC43IDEyLjMgMCAxN0wzMzggMzc3LjZjLTQuNyA0LjctMTIuMyA0LjctMTcgMEwyNTYgMzEybC02NS4xIDY1LjZjLTQuNyA0LjctMTIuMyA0LjctMTcgMEwxMzQuNCAzMzhjLTQuNy00LjctNC43LTEyLjMgMC0xN2w2NS42LTY1LTY1LjYtNjUuMWMtNC43LTQuNy00LjctMTIuMyAwLTE3bDM5LjYtMzkuNmM0LjctNC43IDEyLjMtNC43IDE3IDBsNjUgNjUuNyA2NS4xLTY1LjZjNC43LTQuNyAxMi4zLTQuNyAxNyAwbDM5LjYgMzkuNmM0LjcgNC43IDQuNyAxMi4zIDAgMTdMMzEyIDI1Nmw2NS42IDY1LjF6Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZChzdmdJY29uLCBwYXRoKTtcclxuICAgIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQoY29udGFpbmVyMSwgc3ZnSWNvbik7XHJcblxyXG4gICAgY29uc3QgY29udGFpbmVyMiA9IHRoaXMucmVuZGVyZXIuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKGNvbnRhaW5lcjIsICdmbGV4aS10b2FzdC1jb250YWluZXItMicpO1xyXG5cclxuICAgIGNvbnN0IHRpdGxlRWwgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgIGNvbnN0IHRpdGxlVGV4dCA9IHRoaXMucmVuZGVyZXIuY3JlYXRlVGV4dCh0aXRsZSk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKHRpdGxlRWwsIHRpdGxlVGV4dCk7XHJcblxyXG4gICAgY29uc3QgbWVzc2FnZSA9IHRoaXMucmVuZGVyZXIuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgY29uc3QgbWVzc2FnZVRleHQgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZVRleHQodGV4dCk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKG1lc3NhZ2UsIG1lc3NhZ2VUZXh0KTtcclxuXHJcbiAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKGNvbnRhaW5lcjIsIHRpdGxlRWwpO1xyXG4gICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZChjb250YWluZXIyLCBtZXNzYWdlKTtcclxuXHJcbiAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKGNvbnRhaW5lciwgY29udGFpbmVyMSk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKGNvbnRhaW5lciwgY29udGFpbmVyMik7XHJcblxyXG4gICAgaWYgKG9wdGlvbnMuYXV0b0Nsb3NlICYmIG9wdGlvbnMuc2hvd1Byb2dyZXNzQmFyKSB7XHJcbiAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gdGhpcy5yZW5kZXJlci5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyhwcm9ncmVzc0JhciwgJ2ZsZXhpLXRvYXN0LXByb2dyZXNzLWJhcicpO1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHByb2dyZXNzQmFyLCBgZmxleC10b2FzdC1wcm9ncmVzcy1iYXItJHtvcHRpb25zLmljb259YClcclxuICAgICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZCh0b2FzdCwgcHJvZ3Jlc3NCYXIpO1xyXG5cclxuICAgICAgLy8gQWRkIGFuaW1hdGlvbiB0byBwcm9ncmVzcyBiYXJcclxuICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShwcm9ncmVzc0JhciwgJ3RyYW5zaXRpb24nLCBgd2lkdGggJHtvcHRpb25zLnRpbWVPdXR9bXMgbGluZWFyYCk7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUocHJvZ3Jlc3NCYXIsICd3aWR0aCcsICcxMDAlJyk7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUocHJvZ3Jlc3NCYXIsICd3aWR0aCcsICcwJScpO1xyXG4gICAgICB9LCAxMCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZCh0b2FzdCwgY29udGFpbmVyKTtcclxuXHJcbiAgICBpZiAob3B0aW9ucy5zaG93Q2xvc2VCdG4pIHtcclxuICAgICAgY29uc3QgY2xvc2VCdG4gPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyhjbG9zZUJ0biwgJ2ZsZXhpLXRvYXN0LWNsb3NlLWJ0bicpO1xyXG4gICAgICBjb25zdCBjbG9zZVRleHQgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZVRleHQoJ8OXJyk7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQoY2xvc2VCdG4sIGNsb3NlVGV4dCk7XHJcblxyXG4gICAgICB0aGlzLnJlbmRlcmVyLmxpc3RlbihjbG9zZUJ0biwgJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModG9hc3QsICdmbGV4aS10b2FzdC1mYWRlLWluJyk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0b2FzdCwgJ2ZsZXhpLXRvYXN0LWZhZGUtb3V0Jyk7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNoaWxkKHdyYXBwZXIsIHRvYXN0KTtcclxuICAgICAgICB9LCA1MDApO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQodG9hc3QsIGNsb3NlQnRuKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZCh3cmFwcGVyLCB0b2FzdCk7XHJcblxyXG4gICAgLy8gVGltZW91dCB0byB0cmlnZ2VyIHRoZSBmYWRlLWluIGFuaW1hdGlvblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModG9hc3QsICdmbGV4aS10b2FzdC1mYWRlLWluJyk7XHJcbiAgICB9LCAxMCk7XHJcblxyXG4gICAgaWYgKG9wdGlvbnMuYXV0b0Nsb3NlKSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModG9hc3QsICdmbGV4aS10b2FzdC1mYWRlLWluJyk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0b2FzdCwgJ2ZsZXhpLXRvYXN0LWZhZGUtb3V0Jyk7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNoaWxkKHdyYXBwZXIsIHRvYXN0KTtcclxuICAgICAgICB9LCA1MDApO1xyXG4gICAgICB9LCBvcHRpb25zLnRpbWVPdXQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2hvd1N3YWwodGl0bGU6IHN0cmluZywgdGV4dDogc3RyaW5nLCBjYWxsQmFjazogKCkgPT4gdm9pZCwgY29uZmlybUJ0blRleHQ6IHN0cmluZyA9IHRoaXMub3B0aW9ucy5jb25maXJtQnRuVGV4dCA/PyBcIkRlbGV0ZVwiLCBjYW5jZWxCdG5UZXh0OiBzdHJpbmcgPSB0aGlzLm9wdGlvbnMuY2FuY2VsQnRuVGV4dCA/PyBcIkNhbmNlbFwiKSB7XHJcbiAgICBjb25zdCBib2R5ID0gdGhpcy5yZW5kZXJlci5zZWxlY3RSb290RWxlbWVudCgnYm9keScsIHRydWUpO1xyXG5cclxuICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMucmVuZGVyZXIuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKGNvbnRhaW5lciwgJ2ZsZXhpLXN3YWwtY29udGFpbmVyJyk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZShjb250YWluZXIsIGBkYXRhLWJzLXRoZW1lYCwgdGhpcy5vcHRpb25zLnRoZW1lQ2xhc3MhKVxyXG5cclxuICAgIGNvbnN0IGNvbnRlbnQgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyhjb250ZW50LCAnZmxleGktc3dhbC1jb250ZW50Jyk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKGNvbnRlbnQsIGBmbGV4aS1zd2FsLWNvbnRlbnQtbGVmdC1ib3JkZXItJHt0aGlzLm9wdGlvbnMuc3dhbENvbnRlbnRUaGVtZUNsYXNzfWApO1xyXG5cclxuICAgIC8vIGNvbnN0IGljb25Db250YWluZXIgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgLy8gdGhpcy5yZW5kZXJlci5hZGRDbGFzcyhpY29uQ29udGFpbmVyLCAnZmxleGktc3dhbC1pY29uJyk7XHJcblxyXG4gICAgLy8gY29uc3Qgc3ZnSWNvbiA9IHRoaXMucmVuZGVyZXIuY3JlYXRlRWxlbWVudCgnc3ZnJywgJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyk7XHJcbiAgICAvLyB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZShzdmdJY29uLCAneG1sbnMnLCAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnKTtcclxuICAgIC8vIHRoaXMucmVuZGVyZXIuc2V0QXR0cmlidXRlKHN2Z0ljb24sICd2aWV3Qm94JywgJzAgMCAzMjAgNTEyJyk7XHJcbiAgICAvLyB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHN2Z0ljb24sICd3aWR0aCcsICcyMHB4Jyk7XHJcblxyXG4gICAgLy8gY29uc3QgcGF0aCA9IHRoaXMucmVuZGVyZXIuY3JlYXRlRWxlbWVudCgncGF0aCcsICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycpO1xyXG4gICAgLy8gdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUocGF0aCwgJ2QnLCAnTTgwIDE2MGMwLTM1LjMgMjguNy02NCA2NC02NGgzMmMzNS4zIDAgNjQgMjguNyA2NCA2NHYzLjZjMCAyMS44LTExLjEgNDIuMS0yOS40IDUzLjhsLTQyLjIgMjcuMWMtMjUuMiAxNi4yLTQwLjQgNDQuMS00MC40IDc0VjMyMGMwIDE3LjcgMTQuMyAzMiAzMiAzMnMzMi0xNC4zIDMyLTMydi0xLjRjMC04LjIgNC4yLTE1LjggMTEtMjAuMmw0Mi4yLTI3LjFjMzYuNi0yMy42IDU4LjgtNjQuMSA1OC44LTEwNy43VjE2MGMwLTcwLjctNTcuMy0xMjgtMTI4LTEyOEgxNDRDNzMuMyAzMiAxNiA4OS4zIDE2IDE2MGMwIDE3LjcgMTQuMyAzMiAzMiAzMnMzMi0xNC4zIDMyLTMyem04MCAzMjBhNDAgNDAgMCAxIDAgMC04MCA0MCA0MCAwIDEgMCAwIDgweicpO1xyXG4gICAgLy8gdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZChzdmdJY29uLCBwYXRoKTtcclxuICAgIC8vIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQoaWNvbkNvbnRhaW5lciwgc3ZnSWNvbik7XHJcblxyXG4gICAgY29uc3QgY2xvc2VCdG4gPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyhjbG9zZUJ0biwgJ2ZsZXhpLXN3YWwtY2xvc2UtYnRuJyk7XHJcbiAgICAgIGNvbnN0IGNsb3NlVGV4dCA9IHRoaXMucmVuZGVyZXIuY3JlYXRlVGV4dCgnw5cnKTtcclxuICAgICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZChjbG9zZUJ0biwgY2xvc2VUZXh0KTtcclxuXHJcbiAgICAgIHRoaXMucmVuZGVyZXIubGlzdGVuKGNsb3NlQnRuLCAnY2xpY2snLCAoKSA9PiB7ICAgICAgICBcclxuICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKGNvbnRlbnQsICdmYWRlLW91dCcpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDaGlsZChib2R5LCBjb250YWluZXIpO1xyXG4gICAgICAgIH0sIDIwMCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZChjb250ZW50LCBjbG9zZUJ0bik7XHJcblxyXG4gICAgY29uc3QgdGl0bGVFbCA9IHRoaXMucmVuZGVyZXIuY3JlYXRlRWxlbWVudCgnaDEnKTtcclxuICAgIGNvbnN0IHRpdGxlVGV4dCA9IHRoaXMucmVuZGVyZXIuY3JlYXRlVGV4dCh0aXRsZSk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKHRpdGxlRWwsIHRpdGxlVGV4dCk7XHJcblxyXG4gICAgY29uc3QgbWVzc2FnZSA9IHRoaXMucmVuZGVyZXIuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgY29uc3QgbWVzc2FnZVRleHQgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZVRleHQodGV4dCk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKG1lc3NhZ2UsIG1lc3NhZ2VUZXh0KTtcclxuXHJcbiAgICBjb25zdCBidXR0b25zQ29udGFpbmVyID0gdGhpcy5yZW5kZXJlci5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3MoYnV0dG9uc0NvbnRhaW5lciwgXCJmbGV4aS1zd2FsLWJ0bi1jb250YWluZXJcIik7XHJcblxyXG4gICAgY29uc3QgY29uZmlybUJ1dHRvbiA9IHRoaXMucmVuZGVyZXIuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKGNvbmZpcm1CdXR0b24sICdmbGV4aS1zd2FsLWJ0bicpO1xyXG4gICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShjb25maXJtQnV0dG9uLCAnbWFyZ2luLXJpZ2h0JywgJzVweCcpO1xyXG4gICAgY29uc3QgY29uZmlybUJ1dHRvblRleHQgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZVRleHQoY29uZmlybUJ0blRleHQpO1xyXG4gICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZChjb25maXJtQnV0dG9uLCBjb25maXJtQnV0dG9uVGV4dCk7XHJcblxyXG4gICAgY29uc3QgY2FuY2VsQnV0dG9uID0gdGhpcy5yZW5kZXJlci5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3MoY2FuY2VsQnV0dG9uLCAnZmxleGktc3dhbC1idG4tY2FuY2VsJyk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKGNhbmNlbEJ1dHRvbiwgYGZsZXhpLXN3YWwtYnRuLWNhbmNlbC1iYWNrZ3JvdW5kLSR7dGhpcy5vcHRpb25zLnN3YWxDb250ZW50VGhlbWVDbGFzc31gKTtcclxuICAgIGNvbnN0IGNhbmNlbEJ1dHRvblRleHQgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZVRleHQoY2FuY2VsQnRuVGV4dCk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKGNhbmNlbEJ1dHRvbiwgY2FuY2VsQnV0dG9uVGV4dCk7XHJcblxyXG4gICAgdGhpcy5yZW5kZXJlci5saXN0ZW4oY29uZmlybUJ1dHRvbiwgJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICBjYWxsQmFjaygpO1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKGNvbnRlbnQsICdmYWRlLW91dCcpO1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNoaWxkKGJvZHksIGNvbnRhaW5lcik7XHJcbiAgICAgIH0sIDIwMCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLnJlbmRlcmVyLmxpc3RlbihjYW5jZWxCdXR0b24sICdjbGljaycsICgpID0+IHtcclxuICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyhjb250ZW50LCAnZmFkZS1vdXQnKTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDaGlsZChib2R5LCBjb250YWluZXIpO1xyXG4gICAgICB9LCAyMDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZChidXR0b25zQ29udGFpbmVyLCBjb25maXJtQnV0dG9uKTtcclxuICAgIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQoYnV0dG9uc0NvbnRhaW5lciwgY2FuY2VsQnV0dG9uKTtcclxuXHJcbiAgICAvL3RoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQoY29udGVudCwgaWNvbkNvbnRhaW5lcik7XHJcbiAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKGNvbnRlbnQsIHRpdGxlRWwpO1xyXG4gICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZChjb250ZW50LCBtZXNzYWdlKTtcclxuICAgIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQoY29udGVudCwgYnV0dG9uc0NvbnRhaW5lcik7XHJcblxyXG4gICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZChjb250YWluZXIsIGNvbnRlbnQpO1xyXG5cclxuICAgIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQoYm9keSwgY29udGFpbmVyKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBGbGV4aVRvYXN0T3B0aW9uc01vZGVsIHtcclxuICBpY29uPzogRmxleGlUb2FzdEljb25UeXBlID0gXCJzdWNjZXNzXCI7XHJcbiAgYXV0b0Nsb3NlPzogYm9vbGVhbiA9IHRydWU7XHJcbiAgdGltZU91dD86IG51bWJlciA9IDMwMDA7XHJcbiAgc2hvd1Byb2dyZXNzQmFyPzogYm9vbGVhbiA9IHRydWU7XHJcbiAgc2hvd0Nsb3NlQnRuPzogYm9vbGVhbiA9IHRydWU7XHJcbiAgcHJldmVudER1cGxpY2F0ZT86IGJvb2xlYW4gPSBmYWxzZTtcclxuICBwb3NpdGlvbj86IEZsZXhpVG9hc3RQb3NpdGlvblR5cGUgPSBcImJvdHRvbS1yaWdodFwiXHJcbiAgdGhlbWVDbGFzcz86IEZsZXhpVG9hc3RUaGVtZUNsYXNzVHlwZSB8IHN0cmluZyA9IFwibGlnaHRcIjtcclxuICBjYW5jZWxCdG5UZXh0Pzogc3RyaW5nID0gXCJDYW5jZWxcIjtcclxuICBjb25maXJtQnRuVGV4dD86IHN0cmluZyA9IFwiRGVsZXRlXCI7XHJcbiAgc3dhbENvbnRlbnRUaGVtZUNsYXNzPzogRmxleGlTd2FsQ29udGVudFRoZW1lQ2xhc3MgPSBcImVycm9yXCI7XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIEZsZXhpVG9hc3RJY29uVHlwZSA9IFwic3VjY2Vzc1wiIHwgXCJ3YXJuaW5nXCIgfCBcImluZm9cIiB8IFwiZXJyb3JcIjtcclxuZXhwb3J0IHR5cGUgRmxleGlUb2FzdFRoZW1lQ2xhc3NUeXBlID0gXCJsaWdodFwiIHwgXCJkYXJrXCI7XHJcbmV4cG9ydCB0eXBlIEZsZXhpVG9hc3RQb3NpdGlvblR5cGUgPSBcInRvcC1sZWZ0XCIgfCBcInRvcC1yaWdodFwiIHwgXCJib3R0b20tbGVmdFwiIHwgXCJib3R0b20tcmlnaHRcIiB8IFwiZnVsbC1ib3R0b21cIiB8IFwiZnVsbC10b3BcIjtcclxuZXhwb3J0IHR5cGUgRmxleGlTd2FsQ29udGVudFRoZW1lQ2xhc3MgPSBcInN1Y2Nlc3NcIiB8IFwid2FybmluZ1wiIHwgXCJpbmZvXCIgfCBcImVycm9yXCI7Il19